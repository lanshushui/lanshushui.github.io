---
title: 小知识点
categories:
  - 小知识点
tags:
  - 使用提醒
abbrlink: 89f567a5
---





小知识点

<!-- more -->



## 1.Span

**ReplacementSpan**



## 2.substring可能会把两个字符的emoji分开，导致显示无法显示的?字符。

判断边界字符是否是Unicode代理项代码单元，substring时进行位置偏移

```
Character.isLowSurrogate()

Character.isHighSurrogate()
```



## 2.onSaveInstanceState-onStop

下拉状态栏： onSaveInstanceState ，onPause，onStop 都不会调用

按Home： onPause --onStop--onSaveInstanceState 都会被调用

```java
//ActivityThread类
private void callActivityOnStop(ActivityClientRecord r, boolean saveState, String reason) {
    // Before P onSaveInstanceState was called before onStop, P是安卓9.0版本
    //starting with P it's called after.    Before Honeycomb state was always saved before onPause.
    final boolean shouldSaveState = saveState && !r.activity.mFinished && r.state == null
        && !r.isPreHoneycomb();
    final boolean isPreP = r.isPreP();
    if (shouldSaveState && isPreP) {
        callActivityOnSaveInstanceState(r);
    }

    try {
        r.activity.performStop(r.mPreserveWindow, reason);
    } catch (SuperNotCalledException e) {
        throw e;
    } catch (Exception e) {
        if (!mInstrumentation.onException(r.activity, e)) {
            throw new RuntimeException(
                "Unable to stop activity "
                + r.intent.getComponent().toShortString()
                + ": " + e.toString(), e);
        }
    }
    r.setState(ON_STOP);

    if (shouldSaveState && !isPreP) {
        callActivityOnSaveInstanceState(r);
    }
}
```

安卓9.0版本前onSaveInstanceState在onStop前被调用，安卓9.0版本前onSaveInstanceState在onStop后被调用





Keep Moving Forward
